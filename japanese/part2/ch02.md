# 極限と余極限 {#limits-and-colimits}

圏論では、すべてがすべてに関係していて、すべてのものを様々な角度から見られるようだ。たとえば、[積](#products-and-coproducts)（第5章）の普遍的構成を考えてみよう。いまは[関手](#functors)と[自然変換](#natural-transformations)（第10章）についても学んだので、それらを単純化し、可能なら一般化できないだろうか？　やってみよう。

`\begin{figure}[H] \centering`{=latex}
![](images/productpattern.jpg){width=30%}
`\end{figure}`{=latex}

\noindent
積の構成は、積を構築したい2つの対象$a$と$b$を選択することから始まる。しかし、*対象を選択する*とは何を意味するのだろう？　もっと圏論らしい言葉で言い換えられないだろうか？　2つの対象はあるパターンをなす――ごく単純なパターンだ。このパターンは圏に抽象化できる――ごく単純な圏だが、それでも紛れもなく圏だ。それは$\cat{2}$と呼ばれる圏だ。それは2つの対象（それぞれ$1$と$2$と呼ぶことにする）と、2つの必須の恒等射だけを含む。ここで、$\cat{C}$内の2つの対象を選択するということを、圏$\cat{2}$から$\cat{C}$への関手$D$を定義することだと言い換えられる。関手は対象を対象に写すため、その像はちょうど2つの対象になる（関手が対象を潰す場合は1つの対象になるが、その場合も問題ない）。この関手は射も写すが、ここでは単に恒等射を恒等射に写す。

このアプローチの素晴らしいところは、圏論の概念に基づいて構築されていることであり、「対象を選択する」といった不正確な、我々の祖先たる狩猟採集民の語彙からそのまま採ったような記述を避けていることだ。おまけに、一般化するのも簡単だ。パターンを定義するために$\cat{2}$より複雑な圏を使ってはいけない理由はないからだ。

`\begin{figure}[H] \centering`{=latex}
![](images/two.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
だが、ここではこのまま進もう。積を定義する次のステップは候補となる対象$c$の選択だ。ここでも、単元圏からの関手によって対象の選択を言い換えてしまってもよいかもしれない。そして確かに、もし我々がすでにカン拡張を使っていたとしたら、そうするのが正しかっただろう。しかし、まだカン拡張を使う準備ができていないので、別のトリックを使おう。同じ圏$\cat{2}$から$\cat{C}$への定関手$\Delta$だ。$\Delta_c$によって$\cat{C}$から$c$を選択できる。$\Delta_c$はすべての対象を$c$に写し、すべての射を$\idarrow[c]$に写すことを思い出してほしい。

`\begin{figure}[H] \centering`{=latex}
![](images/twodelta.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
$\Delta_c$と$D$という、$\cat{2}$と$\cat{C}$の間の2つの関手が手に入ったからには、これらの関手の間の自然変換について問うのは自然なことだ。$\cat{2}$の対象は2つだけなので、自然変換は2つの成分を持つことになる。$\cat{2}$内の対象$1$は、$\Delta_c$によって$c$に、$D$によって$a$に写される。したがって、$\Delta_c$と$D$の間の自然変換の$1$における成分は$c$から$a$への射だ。それを$p$と呼ぼう。同様に、2番目の成分は$c$から$b$への射$q$だ。ここで、$b$は$\cat{2}$内の対象$2$の$D$による像だ。しかし、これらはもともとの積の定義で用いた2つの射影とそっくりだ。つまり、対象の選択と射影について議論する代わりに、単に関手の選択と自然変換について議論するのでよいということだ。たまたま、ここでの単純なケースでは変換の自然性条件が自明に満たされている。$\cat{2}$には射が（恒等射以外には）存在しないからだ。

`\begin{figure}[H] \centering`{=latex}
![](images/productcone.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
この構成を$\cat{2}$以外の圏（たとえば、自明でない射を含む圏）に一般化すると、$\Delta_c$と$D$の間の変換に自然性条件が課される。このような変換は*錐*  (cone) と呼ばれる。$\Delta$の像が、自然変換の成分たちが側面を構成するような錐体（円錐・角錐など）^[訳注：原文ではcone/pyramid。]の頂点になっているからだ。$D$の像は錐の底面をなす。

一般に、錐を構築するには、そのパターンを定義する圏$\cat{I}$から始める。$\cat{I}$は小さい圏で、しばしば有限だ。$\cat{I}$から$\cat{C}$への関手$D$を選択し、それ（またはその像）を*図式* (diagram) と呼ぶ。また、$\cat{C}$内の$c$を錐の頂点として選択する。それを使って$\cat{I}$から$\cat{C}$への定関手$\Delta_c$を定義する。$\Delta_c$から$D$への自然変換こそが、ここで言うところの錐となる。有限の$\cat{I}$に対しては、錐は$c$と図式、つまり$D$による$\cat{I}$の像とを接続するただの射の集まりだ。

`\begin{figure}[H] \centering`{=latex}
![](images/cone.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
自然性は、この図式のすべての三角形（角錐の側面）が可換であることを必要とする。実際に、$\cat{I}$内の任意の射$f$を取ったとしよう。関手$D$は、それを$\cat{C}$内の射$D f$に写し、その射はある三角形の底辺となる。定関手$\Delta_c$は、$f$を$c$における恒等射に写す。$\Delta$はその射の両端を1つの対象にまとめ、自然性の正方図式は可換な三角形になる。この三角形の2辺は自然変換の成分になっている。

`\begin{figure}[H] \centering`{=latex}
![](images/conenaturality.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
これは錐のひとつではある。だが、関心があるのは*普遍錐* (universal cone) だ――普遍的な対象を積の定義としたのと同様だ。

その普遍錐の構成を目指す方法はいろいろある。たとえば、与えられた関手$D$に基づいて*錐の圏*を定義できる。その圏における対象は錐だ。ただし、$\cat{C}$のすべての対象$c$が錐の頂点になれるわけではない。$\Delta_c$と$D$の間に自然変換が存在しないことがあるからだ。

圏にするには、錐の間の射も定義しなければならない。それらは頂点間の射によって完全に決定されることになる。しかし、どんな射でも良いわけではない。我々の積の構成では、候補となる対象（頂点）の間の射は射影の共通因子でなければならない、という条件を課したのを思い出してほしい。具体的には

```haskell
p' = p . m
q' = q . m
```

`\begin{figure}[H] \centering`{=latex}
![](images/productranking.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
一般の場合^[訳注：つまり、錐の間の射の場合。]には、この条件は、1辺が分解射である三角形はすべて可換である、という条件に翻訳される。

![分解射$h$によって2つの錐を接続する可換な三角形（ここで、下側の錐は$\Lim[D]$を頂点とする普遍錐）](images/conecommutativity.jpg "分解射$h$によって2つの錐を接続する可換な三角形（ここで、下側の錐は$\Lim[D]$を頂点とする普遍錐）"){width=35%}

\noindent
これらの分解射を錐の圏における射とする。これらの射が実際に合成できることと、恒等射が分解射であることを確認するのは簡単だ。したがって、錐たち^[訳注：「底面」（関手$D$）が同じであるような錐たち。]は圏をなす。

ここで、普遍錐を錐の圏の*終対象*として定義できる。終対象の定義から、どの対象からも終対象への一意な射がある。ここでは、それは他のどの錐の頂点からも普遍錐の頂点への一意な分解射があることを意味する。この普遍錐は図式$D$の*極限* (limit) $\Lim[D]$と呼ばれる（この分野では$\Lim$記号の下に$I$に向かう左矢印が記されていることも多い）。しばしば、この錐の頂点を指して極限（あるいは極限対象）と略称する。

直観的には、極限は図式全体の特性を単一の対象で具現化している。たとえば、2対象の図式の極限は2つの対象の積だ。積（および2つの射影を合わせたもの）には両方の対象についての情報が含まれている。そして、普遍であるということは要らないものを含まないことを意味する。

## 自然同型としての極限

この極限の定義にはまだ不満が残る。どういうことかと言うと、使えはするものの、任意の2つの錐を結ぶ三角形には依然として前述のような可換性条件が課されている。それを何らかの自然性条件に置き換えられれば、はるかにエレガントになるだろう。だが、どうやって？

もはや我々は、1つの錐ではなく、錐の集まり（実際には圏）全体を扱っている。極限が存在するなら（そして――明言しておくと――存在する保証はない）、それらの錐の1つは普遍錐だ。他のすべての錐のそれぞれに対して、その頂点（$c$と呼ぼう）を普遍錐の頂点$\Lim[D]$に写す一意な分解射が存在する。（実際には「他の」という言葉は省ける。普遍錐が恒等射によって普遍錐自身に写され、それ自身を分解するのは自明だからだ。）
要点を繰り返そう。任意の錐について、特別な種類の一意な射が存在する。つまり、それは錐からそういった特別な射への写像があって、それは1対1の写像であるということだ。

この特別な射はhom集合$\cat{C}(c, \Lim[D])$ の元だ。このhom集合のそれ以外の元は、残念ながら2つの錐の写像を分解しない。ここで必要なのは、$c$ごとに、$\cat{C}(c, \Lim[D])$ から1つの射――特定の可換性条件を満たす射――を選択できるようにすることだ。まるで自然変換を定義しているかのように聞こえるだろうか？　まさしくそのとおり！

だが、この変換によって関連付けられるのはどのような関手だろう？

関手の1つは、$c$から集合$\cat{C}(c, \Lim[D])$ への写像だ。これは$\cat{C}$から$\Set$への関手で、対象たちを集合たちに写す。正確には反変関手だ。射に関する作用は次のように定める。$c'$から$c$への射$f$を取ってきたとしよう。
$$f \Colon c' \to c$$
我々の関手は$c'$を集合$\cat{C}(c', \Lim[D])$ に写す。この関手の$f$に対する作用を定義する（言い換えると、$f$を持ち上げる）には、それに対応する、$\cat{C}(c, \Lim[D])$ と$\cat{C}(c', \Lim[D])$ の間の写像を定義しなければならない。そこで、$\cat{C}(c, \Lim[D])$ の要素$u$を1つ選択し、それを$\cat{C}(c', \Lim[D])$ の要素に写せるか見てみよう。hom集合の要素は射なので、次のことが言える。
$$u \Colon c \to \Lim[D]$$
$u$を$f$に前合成^[訳注：本書で前合成 (precomposition) や後合成 (postcomposition) と言うときは$\circ$の左側を前としている。]することで次が得られる。
$$u \circ f \Colon c' \to \Lim[D]$$
そして、これは$\cat{C}(c', \Lim[D])$ の要素だ――つまり、実際に射の写像が見つかった。

```haskell
contramap :: (c' -> c) -> (c -> Lim D) -> (c' -> Lim D)
contramap f u = u . f
```

\noindent
*反変*関手の特徴である、$c$と$c'$の順序の反転に注目してほしい。

`\begin{figure}[H] \centering`{=latex}
![](images/homsetmapping.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
自然変換を定義するには、同じく$\cat{C}$から$\Set$への写像である別の関手が必要だ。今回については錐の集合を考えてみる。錐は単なる自然変換なので、自然変換の集合$\Nat(\Delta_c, D)$ を見ていることになる。$c$をこの特定の自然変換の集合へ対応させる写像は（反変）関手となる。どうやってそれを示そう？　ここでも、次の射に対するその関手の作用を定義してみよう。
$$f \Colon c' \to c$$
$f$を持ち上げると$\cat{I}$から$\cat{C}$へ向かう2つの関手間の自然変換たちの写像になる必要がある。つまり、
$$\Nat(\Delta_c, D) \to \Nat(\Delta_{c'}, D)$$
自然変換はどう写せば良いだろう？　自然変換は射――その成分――の選択であり、$\cat{I}$の要素ごとに射を1つ選択する。ある（$\Nat(\Delta_c, D)$ の元である）$\alpha$の、（$\cat{I}$内の対象である）$a$における成分は、次の射となる。
$$\alpha_a \Colon \Delta_c a \to D a$$
つまり、定関手$\Delta$の定義から
$$\alpha_a \Colon c \to D a$$
となる。任意の$f$と$\alpha$について、$\Nat(\Delta_{c'}, D)$ の元である$\beta$を構築する必要がある。$\beta$の$a$における成分は次の射となる。
$$\beta_a \Colon c' \to D a$$
後者（$\beta_a$）は前者（$\alpha_a$）を$f$に前合成すれば簡単に得られる。
$$\beta_a = \alpha_a \circ f$$
これらの成分たちが実際に自然変換をなすことは比較的簡単に示せる。

`\begin{figure}[H] \centering`{=latex}
![](images/natmapping.jpg){width=40%}
`\end{figure}`{=latex}

\noindent
以上より、与えられた射$f$について、2つの自然変換の間の写像を成分ごとに構築できた。この写像は次の関手について`contramap`を定義する[^mapsto]。
$$c \to \Nat(\Delta_c, D)$$
ここまでで示したのは、$\cat{C}$から$\Set$への2つの（反変）関手があるということだ。示すにあたっては何の仮定も置かなかった。よって、これらの関手は常に存在すると言える。

[^mapsto]: 訳注：ここでは写像による元の対応について述べているので、より適切な書き方としては$c \mapsto \Nat(\Delta_c, D)$となる。

ちなみに、これらの関手のうち1つ目は圏論で重要な役割を果たしている。米田の補題について話すときに再び見ることになるだろう。任意の圏$\cat{C}$から$\Set$への反変関手は「前層」(presheaf) と呼ばれる。ここでのものは[*表現可能前層*]{.keyword #representable_presheaf}\index{表現可能前層} (representable presheaf) と呼ばれている。2つ目の関手も前層だ。

2つの関手が出てきたので、その間の自然変換について述べられるようになった。では、これ以上何も言わず、結論を述べよう。$\cat{I}$から$\cat{C}$への関手$D$が極限$\Lim[D]$を持つのは、先ほど定義した2つの関手間に自然同型がある場合、かつその場合に限る。
$$\cat{C}(c, \Lim[D]) \simeq \Nat(\Delta_c, D)$$
自然同型とは何かを思い出してほしい。すべての成分が同型、すなわち可逆な射である自然変換だった。

この命題の証明をなぞるつもりはない。退屈とまでは言わないにしても、ごく単純な手順で済むからだ。自然変換を扱うときには通常、その成分、つまり射に注目する。ここでは両方の関手の余域が$\Set$なので、前述の自然同型の成分は関数になる。そして、それらの関数はhom集合から自然変換の集合へと向かうので、高階関数となる。再び、関数が引数に対して何を行うかを調べることで関数を分析できる。ここで、引数は$\cat{C}(c, \Lim[D])$ の元である射になり、結果は$\Nat(\Delta_c, D)$ の元である自然変換、すなわち錐と呼んだものになる。この自然変換自身にもそれぞれの成分があり、それらは射だ。このようにどこまでも射が続くので、それらを追跡できれば先ほどの命題を証明できる。

最も重要な結果は、この同型に対する自然性条件がまさしく錐の写像についての可換性条件になっているということだ。

今後のアトラクションの予告として、集合$\Nat(\Delta_c, D)$ を関手圏のhom集合と見なせることに触れておきたい。つまり、ここでの自然同型は2つのhom集合を関連づけ、随伴と呼ばれるさらに一般的な関係を指し示している。

## 極限の例

すでに見たように、圏論的な積は、$\cat{2}$と呼ばれる単純な圏が生成する図式の極限だ。

極限のさらに単純な例としては終対象がある。単元圏が終対象につながる、と初期衝動で考えるかもしれないが、真実はさらに殺風景だ。終対象は空圏が生成する極限なのだ。空圏からの関手は対象を選択しないので、錐は頂点だけに収縮する。普遍錐はその唯一の頂点で、他の頂点からの一意な射を持つ。これが終対象の定義だと気付くだろう。

次に興味深い極限は*等化子* (equalizer) と呼ばれる。これは2つの要素からなる圏によって生成された極限であり、要素間の2つの並行した射を伴う（そして当然、恒等射も持つ）。この圏は、2つの対象$a$と$b$と、2つの射とで構成される$\cat{C}$の図式を選択する。

```haskell
f :: a -> b
g :: a -> b
```

\noindent
この図式の上に錐を構築するには、頂点$c$と2つの射影を追加する必要がある。

```haskell
p :: c -> a
q :: c -> b
```

`\begin{figure}[H] \centering`{=latex}
![](images/equalizercone.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
可換でなければならない三角形が2つある。

```haskell
q = f . p
q = g . p
```

\noindent
これは$q$が、これらの等式の1つ、たとえば`q = f . p`によって一意に決定され、図から省けることを示している。残りの条件は1つだけになる。

```haskell
f . p = g . p
```

\noindent
これは、注目する範囲を$\Set$だけに限れば、関数$p$の像は$a$の部分集合を選択している、と解釈できる。この部分集合に限れば、関数$f$と$g$は等しくなる。

たとえば、$a$を座標$x$と$y$でパラメーター化された2次元平面とする。$b$を実数の直線とし、次のようにする。

```haskell
f (x, y) = 2 * y + x
g (x, y) = y - x
```

\noindent
これら2つの関数の等化子は、実数の集合（頂点$c$）と次の関数だ。

```haskell
p t = (t, (-2) * t)
```

\noindent
$(p~t)$ は2次元平面内の直線を定義することに注意してほしい。この線上では2つの関数は等しい。

当然、この等しさは他の集合$c'$と関数$p'$でも満たしうる。

```haskell
f . p' = g . p'
```

\noindent
ただし、それらはすべて$p$を通じて一意に分解する。たとえば、単元集合$\cat{()}$を$c'$として受け取れば次の関数を使える。

```haskell
p'() = (0, 0)
```

\noindent
$f(0, 0) = g(0, 0)$ だから、これは良い錐だ。しかし、普遍錐ではなく、$h$によって一意に分解できる。

```haskell
p' = p . h
```

\noindent
ここで、

```haskell
h () = 0
```

`\begin{figure}[H] \centering`{=latex}
![](images/equilizerlimit.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
したがって、等化子は型$f~x = g~x$の方程式を解くのに使える。しかも、もっと一般化されている。代数的な定義ではなく、対象や射によって定義されているからだ。

方程式を解くという考え方をさらに一般化したものが、別の極限で具体化されている――引き戻し (pullback) だ。ここに、等価にしたい2つの射がまたあるが、今回はそれらの始点が異なる。まず$1\rightarrow2\leftarrow3$という形の3対象の圏から始める。この圏に対応する図式は、3つの対象（$a$, $b$, $c$）と2つの射で構成されている。

```haskell
f :: a -> b
g :: c -> b
```

\noindent
この図式は*余スパン* (cospan) と呼ばれることが多い。

この図式の上に構築された錐は、頂点$d$と3つの射から構成されている。

```haskell
p :: d -> a
q :: d -> c
r :: d -> b
```

`\begin{figure}[H] \centering`{=latex}
![](images/pullbackcone.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
可換性条件から$r$は他の射によって完全に決定されることが分かり、図から省略できる。したがって、次の条件のみが残る。

```haskell
g . q = f . p
```

\noindent
引き戻しは、この形の普遍錐だ。

`\begin{figure}[H] \centering`{=latex}
![](images/pullbacklimit.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
再び、注目する範囲を集合だけに絞ると、対象$d$は$a$と$c$からの要素のペアのうち、$f$が1番目の成分に作用したものと$g$が2番目の成分に作用したものとが等しいという条件を満たすものからなると見なせる。これがまだ一般的すぎるなら、$g$が定数関数である特別な場合を考えてみてほしい。たとえば、（$b$が実数の集合だと仮定して）$g~\_ = 1.23$とする。そうすれば、実際に方程式を解いていることになる。

```haskell
f x = 1.23
```

\noindent
この場合、$c$として何を選択しても（空集合でない限り）関係ないので、単元集合として構わない。たとえば、集合$a$が3次元ベクトルの集合で、$f$がベクトル長だとする。そうすれば、引き戻しはペア $(v, ())$ の集合で、$v$は長さ1.23のベクトル（方程式$\sqrt{(x^{2}+y^{2}+z^{2})} = 1.23$の解）となる。$()$ は単元集合のダミー要素だ。

もっとも、引き戻しにはより一般的な用途があり、プログラミングでも使える。たとえば、C++のクラスを圏と見なし、派生クラスを基底クラスに結ぶ矢印を射と見なそう。継承関係は推移的だと見なせる。つまり、`C`が`B`を継承し、`B`が`A`を継承しているなら、`C`は`A`を継承していると言える（要するに、`A`へのポインターを想定する箇所に`C`へのポインターを渡せるということだ）。また、`C`は`C`を継承すると見なそう。つまり、すべてのクラスに恒等射がある。このようにすれば、派生クラス関係は部分型関係と一致することになる。C++は多重継承もサポートしているので、`A`を継承する2つのクラス`B`と`C`、および`B`と`C`とを多重継承する4番目のクラス`D`を含むダイヤモンド継承の図式を構築できる。通常、`D`は`A`を2つ持つことになる。ほとんどの場合、これは望ましくない。だが、仮想継承を使えば`D`内の`A`を1つだけにできる。

`D`がこの図式の引き戻しになるとは何を意味するのだろう？　それは、`B`と`C`を多重継承するすべてのクラス`E`が、`D`の派生クラスでもあることを意味する。これはC++では直接表現できない。C++の部分型付け^[訳注：つまり、派生クラス関係。]は名前に基づくもの (nominal) だからだ（C++コンパイラーはこの種のクラス関係を推測しない――それには「ダックタイピング」が必要となる[^ducktyping]）。しかし、部分型付け関係の外に出て、代わりに`E`から`D`へのキャストが安全かどうか確かめることはできる。このキャストが安全なのは、`D`が`B`と`C`の必要最小限の組み合わせで、追加データやメソッドのオーバーライドがない場合だ。そしてもちろん、`B`と`C`のメソッドに名前の衝突がある場合、引き戻しはない。

[^ducktyping]: 訳注：ダックタイピングは主に動的言語で用いられるが、動的な枠組みを使わずともここでの目的は達成できる。C++ではテンプレートによる手法が知られており、また、構造的部分型付けを行う言語でも実現できる。

`\begin{figure}[H] \centering`{=latex}
![](images/classes.jpg){width=25%}
`\end{figure}`{=latex}

\noindent
さらに、型推論では引き戻しがより高度な使い方をされる。2つの表現の型を*単一化* (unify) したいことはよくある。たとえば、コンパイラーが関数の型を推測しようとしているとする。

```haskell
twice f x = f (f x)
```

\noindent
これはすべての変数と部分式に予備的な型を割り当てる。具体的には、以下を割り当てる。

```haskell
f       :: t0
x       :: t1
f x     :: t2
f (f x) :: t3
```

\noindent
そこから次のことが演繹される。

```haskell
twice :: t0 -> t1 -> t3
```

\noindent
また、関数適用の規則から生じる一連の制約も課される。

```haskell
t0 = t1 -> t2 -- fがxに適用されるため
t0 = t2 -> t3 -- fが (f x) に適用されるため
```

\noindent
これらの制約は、両方の式の未知の型に代入したときに両辺が同じになるような型（あるいは型変数）の集合を見つけることによって単一化される。そのような代入の1つは次のとおりだ。

```haskell
t1 = t2 = t3 = Int
twice :: (Int -> Int) -> Int -> Int
```

\noindent
しかし、明らかに、これは最も一般的なものではない。最も一般的な代入^[訳注：最汎単一化子 (most general unifier) と呼ばれる。]を得るには引き戻しを用いる。詳細は本書の範囲外であるため説明しないが、次のような結果になるはずであることは確信できるだろう。

```haskell
twice :: (t -> t) -> t -> t
```

\noindent
ここで`t`は自由 (free) 型変数だ。

## 余極限

圏論のすべての構造と同じく、極限には双対となる像が反対圏にある。錐内のすべての射の方向を反転させると余錐 (co-cone) ができ、余錐たちのうち普遍なものが余極限 (colimit) と呼ばれる。反転が分解射にも影響することに注意してほしい。分解射は普遍な余錐から他の余錐へと向かうことになる。

![2つの頂点を結ぶ分解射`h`を持つ余錐。](images/colimit.jpg "2つの頂点を結ぶ分解射`h`を持つ余錐。"){width=35%}

\noindent
余極限の典型的な例は余積だ。これは、積の定義で使った$\cat{2}$-圏によって生成される図式に対応する。

`\begin{figure}[H] \centering`{=latex}
![](images/coproductranking.jpg){width=35%}
`\end{figure}`{=latex}

\noindent
積も余積も、別々の方法で対象のペアの本質を具現化している。

終対象が極限であったように、始対象は空圏に基づく図式に対応する余極限だ。

引き戻しの双対は*押し出し* (pushout) と呼ばれる。それは圏$1\leftarrow2\rightarrow3$によって生成されるスパン (span) と呼ばれる図式に基づく。

## 連続性

すでに述べたように、関手は圏の連続写像の概念に近い。既存の接続（射）を決して壊さないからだ。圏$\cat{C}$から$\cat{C'}$への*連続関手* (continuous functor) $F$の実際の定義には、関手が極限を保存するという要件が含まれている。$\cat{C}$内のすべての図式$D$は、単に2つの関手を合成すれば、$\cat{C'}$内の図式$F \circ D$に写せる。$F$の連続性条件は、図式$D$が極限$\Lim[D]$を有するなら、図式$F \circ D$も極限を有し、それは$F (\Lim[D])$ に等しいことを示している。

`\begin{figure}[H] \centering`{=latex}
![](images/continuity.jpg){width=60%}
`\end{figure}`{=latex}

\noindent
関手は射を射に、合成を合成に写すので、錐の像は常に錐であることに注意してほしい。可換な三角形は常に可換な三角形に写される（関手は合成を保存する）。分解射についても同じことが言えて、分解射の像も分解射となる。したがって、どの関手も*ほぼ*連続している。問題になりうるのは一意性条件だ。$\cat{C'}$の分解射は一意でないことがある。$\cat{C'}$には、$\cat{C}$にはなかった「より優れた錐」が他にあるかもしれない。

Hom関手は連続関手の一例だ。Hom関手$\cat{C}(a, b)$ が、1番目の変数について反変であり、2番目の変数について共変であることを思い出してほしい。言い換えれば、次の関手だ。
$$\cat{C}^\mathit{op} \times{} \cat{C} \to \Set$$
第2引数が固定されると、hom集合関手（表現可能前層になる）は$\cat{C}$の余極限を$\Set$の極限に写す。第1引数が固定されると、極限を極限に写す。

Haskellでのhom関手は、任意の2つの型を関数型に対応させる写像であるため、単なるパラメーター化された関数型だ。2番目のパラメーターを、たとえば`String`に固定すると、次の反変関手が得られる。

```haskell
newtype ToString a = ToString (a -> String)
instance Contravariant ToString where
    contramap f (ToString g) = ToString (g . f)
```

\noindent
連続性は、`ToString`が余極限、たとえば余積`Either b c`に適用された場合に極限を生成することを意味する。この場合、極限は2つの関数型の積である。つまり、

```haskell
ToString (Either b c) ~ (b -> String, c -> String)
```

\noindent
実際に、`Either b c`のどんな関数も、関数のペアに対応する2つの場合分けを持つ`case`式として実装される。

同様に、hom集合の第1引数を固定すると、おなじみのreader関手が得られる。その連続性は、たとえば、積を返す関数どの関数も積と等価であることを意味する。具体的にはこうなる。

```haskell
r -> (a, b) ~ (r -> a, r -> b)
```

\noindent
読者がどう思っているかは分かっている。これらを理解するのに圏論は必要ない。そのとおりだ！　それでも、このような結果がビットやバイト、プロセッサーアーキテクチャ、コンパイラー技術、さらにはラムダ計算に頼ることなく第一原理から得られるのは驚くべきことだと思う。

「極限」と「連続性」という名前の由来が何なのか気になるなら、それらは微積分学において対応する概念を一般化したものだ。微積分学では、極限と連続性は開近傍によって定義される。開集合たちは、位相 (topology) を定義し、圏（半順序集合）もなす。

## 課題

#. C++のクラスの圏における押し出しはどのようなものだろうか？

#. 恒等関手$\mathbf{Id} \Colon \cat{C} \to \cat{C}$の極限が始対象であることを示せ。

#. 与えられた集合の部分集合たちは圏をなす。その圏の射は、1番目の集合が2番目の集合の部分集合である場合、それら2つの集合を接続する矢として定義される。そのような圏内の集合2つの引き戻しは何か？
   押し出しは何か？
   始対象と終対象は何か？

#. 余等化子 (coequalizer) とは何か予想できるか？

#. 終対象が存在する圏では、終対象に向かう引き戻しが積であることを示せ。

#. 同様に、始対象が存在するなら、始対象からの押し出しが余積であることを示せ。
